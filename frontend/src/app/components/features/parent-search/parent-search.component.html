<div class="container my-4">
  <h3 class="mb-4 text-center text-primary fw-bold">Search My Child</h3>

  <div class="input-group mb-3">
    <input type="text" class="form-control" placeholder="Enter child’s name or phone" [(ngModel)]="query" />
    <div class="input-group-append">
      <button class="btn btn-primary" (click)="onSearch()" [disabled]="!query.trim()">Search</button>
    </div>
  </div>

  <div *ngIf="loading" class="alert alert-info">Searching…</div>
  <div *ngIf="errorMsg" class="alert alert-danger">{{ errorMsg }}</div>

  <ul class="list-group" *ngIf="!loading && !errorMsg && results.length">

    <li class="list-group-item d-flex justify-content-between align-items-center" *ngFor="let r of results">
      <span>{{ r.firstName }} {{ r.lastName }} — {{ r.tel }}</span>
      <div>
        <button *ngIf="r._id && !r.alreadyLinked; else linkedInfo" class="btn btn-sm btn-success" (click)="onLink(r._id!)">
          Link
        </button>
        <ng-template #linkedInfo>
          <span class="badge bg-secondary" *ngIf="r.alreadyLinked === 'you'">
            Already linked to you
          </span>
          <span class="badge bg-danger" *ngIf="r.alreadyLinked === 'other'">
            Linked to another parent
          </span>
        </ng-template>
      </div>
    </li>

  </ul>

  <div *ngIf="!loading && !errorMsg && !results.length" class="text-muted">
    No child found for "{{ query }}"
  </div>
</div>